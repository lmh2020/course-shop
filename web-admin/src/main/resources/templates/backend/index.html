<!doctype html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="page/header :: copy(~{::title}, ~{}, ~{}, ~{})">
    <title>在线课程</title>
  </head>

  <body class="noteplus-layout">
    <div>
        <!-- loader Start -->
        <div th:insert="~{page/loading :: copy}"/>
        <div class="wrapper">
            <!-- 左侧个人信息 -->
            <div th:insert="~{page/sidebar-left :: copy}"/>

            <div class="content-page" id="pageContent">
                <div class="container-fluid note-details">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card card-block card-stretch">
                                <div class="card-body custom-notes-space">
                                    <div class="iq-tab-content">
                                        <div class="d-flex flex-wrap align-items-top justify-content-between">
                                            <ul class="d-flex nav nav-pills text-center note-tab mb-3" id="note-pills-tab" role="tablist">
                                                <li class="nav-item">
                                                    <a @click="getCourseList()" class="nav-link home active show" data-toggle="pill" data-init="note" href="#note1" role="tab" aria-selected="false">课程大厅</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a @click="getCourseList('TRUE')" class="nav-link home" data-toggle="pill" data-init="shared-note" href="#note2" role="tab" aria-selected="true">我的发布</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a @click="getCourseList(null, 'TRUE')" class="nav-link home" data-toggle="pill" data-init="pin-note" href="#note3" role="tab" aria-selected="false">我的购买</a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="note-content tab-content">
                                            <div id="note1" class="tab-pane fade active show">
                                                <div class="icon active animate__animated animate__fadeIn i-grid">
                                                    <div class="row">
                                                        <div v-for="course in courseList" class="col-lg-4 col-md-6">
                                                            <div class="card card-block card-stretch card-height card-bottom-border-info note-detail">
                                                                <div class="card-header d-flex justify-content-between pb-1">
                                                                    <div class="icon iq-icon-box-2 icon-border-info rounded">
                                                                        <svg width="23" class="svg-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                                        </svg>
                                                                    </div>
                                                                    <div class="card-header-toolbar d-flex align-items-center">
                                                                        <div class="card-header-toolbar d-flex align-items-center">
                                                                            <div class="dropdown">
                                                                                <span class="dropdown-toggle dropdown-bg" data-toggle="dropdown" aria-expanded="false" role="button">
                                                                                    <i class="ri-more-fill"></i>
                                                                                </span>
                                                                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="note-dropdownMenuButton8" style="">
                                                                                    <a @click="http.go('course-info', {courseId: course.id})" class="dropdown-item new-note5" data-toggle="modal" data-target="#new-note5"><i class="las la-eye mr-3"></i>查看课程</a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="card-body rounded">
                                                                    <h4 class="card-title">{{course.name}}</h4>
                                                                    <ul class="row mb-0 p-0 list-inline flex-wrap align-items-center">
                                                                        <li class="col-12" style="height: 200px;overflow-y: auto;">
                                                                            <a href="#">
                                                                                <img @click="http.go('course-info', {courseId: course.id})" :src="course.img" class="img-fluid note-image rounded" alt="" />
                                                                            </a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                                <div class="card-footer">
                                                                    <div class="d-flex align-items-center justify-content-between note-text note-text-primary">
                                                                        <a href="#" class=""><i class="las la-user-friends mr-2 font-size-20"></i>{{course.sales}}</a>
                                                                        <a href="#" class="">
                                                                            <img :src="course.user.avatar" class="img-fluid rounded avatar-30" alt="user">
                                                                            [{{course.user.nickName}}]发布于 <i class="las la-calendar mr-2 font-size-20"></i>{{course.createTime}}</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="note2" class="tab-pane fade">
                                                <div class="icon active animate__animated animate__fadeIn i-grid">
                                                    <div class="row">
                                                        <div v-for="course in courseList" class="col-lg-4 col-md-6">
                                                            <div class="card card-block card-stretch card-height card-bottom-border-info note-detail">
                                                                <div class="card-header d-flex justify-content-between pb-1">
                                                                    <div class="icon iq-icon-box-2 icon-border-info rounded">
                                                                        <svg width="23" class="svg-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                                        </svg>
                                                                    </div>
                                                                    <div class="card-header-toolbar d-flex align-items-center">
                                                                        <div class="card-header-toolbar d-flex align-items-center">
                                                                            <div class="dropdown">
                                                                                <span class="dropdown-toggle dropdown-bg" data-toggle="dropdown" aria-expanded="false" role="button">
                                                                                    <i class="ri-more-fill"></i>
                                                                                </span>
                                                                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="note-dropdownMenuButton8" style="">
                                                                                    <a @click="http.go('course-info', {courseId: course.id})" class="dropdown-item new-note5" data-toggle="modal" data-target="#new-note5"><i class="las la-eye mr-3"></i>查看课程</a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="card-body rounded">
                                                                    <h4 class="card-title">{{course.name}}</h4>
                                                                    <ul class="row mb-0 p-0 list-inline flex-wrap align-items-center">
                                                                        <li class="col-12" style="height: 200px;overflow-y: auto;">
                                                                            <a href="#">
                                                                                <img @click="http.go('course-info', {courseId: course.id})" :src="course.img" class="img-fluid note-image rounded" alt="" />
                                                                            </a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                                <div class="card-footer">
                                                                    <div class="d-flex align-items-center justify-content-between note-text note-text-primary">
                                                                        <a href="#" class=""><i class="las la-user-friends mr-2 font-size-20"></i>{{course.sales}}</a>
                                                                        <a href="#" class="">
                                                                            <img :src="course.user.avatar" class="img-fluid rounded avatar-30" alt="user">
                                                                            [{{course.user.nickName}}]发布于 <i class="las la-calendar mr-2 font-size-20"></i>{{course.createTime}}</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="note3" class="tab-pane fade">
                                                <div class="icon active animate__animated animate__fadeIn i-grid">
                                                    <div class="row">
                                                        <div v-for="course in courseList" class="col-lg-4 col-md-6">
                                                            <div class="card card-block card-stretch card-height card-bottom-border-info note-detail">
                                                                <div class="card-header d-flex justify-content-between pb-1">
                                                                    <div class="icon iq-icon-box-2 icon-border-info rounded" id="note-icon">
                                                                        <svg width="23" class="svg-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                                        </svg>
                                                                    </div>
                                                                    <div class="card-header-toolbar d-flex align-items-center">
                                                                        <div class="card-header-toolbar d-flex align-items-center">
                                                                            <div class="dropdown">
                                                                                <span class="dropdown-toggle dropdown-bg" id="note-dropdownMenuButton81"
                                                                                      data-toggle="dropdown" aria-expanded="false" role="button">
                                                                                    <i class="ri-more-fill"></i>
                                                                                </span>
                                                                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="note-dropdownMenuButton8" style="">
                                                                                    <a @click="http.go('course-info', {courseId: course.id})" class="dropdown-item new-note5" data-toggle="modal" data-target="#new-note5"><i class="las la-eye mr-3"></i>查看课程</a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="card-body rounded">
                                                                    <h4 class="card-title">{{course.name}}</h4>
                                                                    <ul class="row mb-0 p-0 list-inline flex-wrap align-items-center">
                                                                        <li class="col-12" style="height: 200px;overflow-y: auto;">
                                                                            <a href="#">
                                                                                <img @click="http.go('course-info', {courseId: course.id})" :src="course.img" class="img-fluid note-image rounded" alt="" />
                                                                            </a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                                <div class="card-footer">
                                                                    <div class="d-flex align-items-center justify-content-between note-text note-text-primary">
                                                                        <a href="#" class=""><i class="las la-user-friends mr-2 font-size-20"></i>{{course.sales}}</a>
                                                                        <a href="#" class="">
                                                                            <img :src="course.user.avatar" class="img-fluid rounded avatar-30" alt="user">
                                                                            [{{course.user.nickName}}]发布于 <i class="las la-calendar mr-2 font-size-20"></i>{{course.createTime}}</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="pages" style="margin: 20px 0 20px 0;"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 底部栏 -->
        <div th:insert="~{page/footer :: copy}"/>
    </div>

    <!-- JS文件 -->
<!--    <div th:replace="~{page/script :: copy}"/>-->
  </body>
</html>

<script>
    const vm = new Vue({
        el: '#pageContent',
        data: {
            courseList: [],
        },
        created() {
            this.init()
        },
        methods: {
            init(){
                this.getCourseList()
            },

            getCourseList(isMy = null, buyed = null, page = 1){
                const _this = this
                this.courseList = []
                http.page("/system/course/page", {
                    pageNum: page,
                    pageSize: 6,
                    isMy: isMy,
                    buyed: buyed
                }, function (res){
                    _this.courseList = res.rows
                    let pageCount = Math.ceil(res.total / 6)
                    if (pageCount % 2 === 0){
                        pageCount++
                    }
                    new Pagination({
                        element: '#pages',
                        type: 1,
                        pageIndex: page,
                        pageSize: 6,
                        pageCount: pageCount,
                        total: res.total,
                        jumper: true,
                        singlePageHide: false,
                        prevText: '上一页',
                        nextText: '下一页',
                        disabled: true,
                        currentChange: function(index) {
                            _this.getCourseList(isMy, buyed, index);
                        }
                    });
                })
            }
        }
    })
</script>
